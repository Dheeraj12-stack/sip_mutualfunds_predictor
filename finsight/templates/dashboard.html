<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SIP Mutual Funds Predictor by AI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #bbdefb, #e3f2fd);
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 0;
            color: #0d47a1;
        }

        .header-banner {
            background: linear-gradient(to right, #0d47a1, #1976d2);
            color: white;
            text-align: center;
            padding: 20px 0;
            font-size: 30px;
            font-weight: bold;
            letter-spacing: 1px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .container {
            max-width: 900px;
            margin: 40px auto;
            background: white;
            padding: 35px;
            border-radius: 20px;
            box-shadow: 0 6px 25px rgba(13, 71, 161, 0.25);
        }

        h1 {
            text-align: center;
            color: #0d47a1;
            font-size: 32px;
            margin-bottom: 5px;
        }

        .subtitle {
            text-align: center;
            color: #1565c0;
            font-size: 16px;
            margin-bottom: 20px;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        label {
            font-weight: bold;
        }

        input {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #90caf9;
            background-color: #f1f8ff;
            font-size: 15px;
        }

        button {
            background-color: #0d47a1;
            color: white;
            padding: 12px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: 0.3s;
        }

        button:hover {
            background-color: #1565c0;
        }

        .ai-advice {
            background: #bbdefb;
            border-left: 6px solid #1976d2;
            margin-top: 20px;
            padding: 15px;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .results {
            background-color: #e3f2fd;
            border-left: 6px solid #0d47a1;
            margin-top: 25px;
            padding: 20px;
            border-radius: 15px;
        }

        .footer {
            background-color: #0d47a1;
            color: white;
            text-align: center;
            padding: 12px;
            font-size: 14px;
            margin-top: 50px;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }

        .highlight {
            color: #0d47a1;
            font-weight: bold;
        }

        #insightSection {
            display: none;
            margin-top: 25px;
            animation: fadeIn 0.7s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        canvas {
            margin-top: 15px;
            width: 100% !important;
            height: 350px !important;
        }
    </style>
</head>
<body>
    <div class="header-banner">
        ðŸ’¹ SIP Mutual Funds Predictor by AI
    </div>

    <div class="container">
        <div class="subtitle">Smarter Investing, Powered by AI Vision</div>

        <div class="ai-advice" id="aiAdvice">
            ðŸ’¬ Based on popular investor trends, if you invest <span class="highlight">â‚¹2000</span> monthly for 
            <span class="highlight">10 years</span> at <span class="highlight">12%</span> annual rate, 
            you could get around <span class="highlight">â‚¹4,64,000</span>. Try adjusting values below to see your future wealth!
        </div>

        <form method="POST">
            {% csrf_token %}
            <label for="monthly_investment">Monthly Investment (â‚¹):</label>
            <input type="number" name="monthly_investment" id="monthly_investment" required placeholder="e.g., 5000" oninput="updateAIAdvice()">

            <label for="annual_rate">Expected Annual Rate (%):</label>
            <input type="number" step="0.1" name="annual_rate" id="annual_rate" required placeholder="e.g., 12" oninput="updateAIAdvice()">

            <label for="years">Investment Duration (Years):</label>
            <input type="number" name="years" id="years" required placeholder="e.g., 10" oninput="updateAIAdvice()">

            <button type="submit">Calculate</button>
        </form>

        <button id="showInsights" onclick="toggleInsights()">ðŸ“ˆ Show More Insights</button>

        <div id="insightSection">
            <canvas id="growthChart"></canvas>
            <div class="ai-advice" id="aiInsightText"></div>
        </div>

        {% if results %}
        <div class="results">
            <h3>ðŸ“Š Investment Summary</h3>
            <p><strong>Total Investment:</strong> â‚¹{{ results.total_investment }}</p>
            <p><strong>Future Value:</strong> â‚¹{{ results.future_value }}</p>
            <p><strong>Estimated Gain:</strong> â‚¹{{ results.gain }}</p>

            <h4>Entered Details:</h4>
            <p>ðŸ’° Monthly Investment: â‚¹{{ user_data.monthly_investment }}</p>
            <p>ðŸ“ˆ Annual Rate: {{ user_data.annual_rate }}%</p>
            <p>ðŸ•“ Duration: {{ user_data.years }} years</p>
        </div>
        {% endif %}
    </div>

    <div class="footer">
        Â© 2025 SIP Mutual Funds Predictor by AI â€” Powered by Dheeraj
    </div>

    <script>
        let chart;

        function updateAIAdvice() {
            const monthly = parseFloat(document.getElementById("monthly_investment").value) || 2000;
            const rate = parseFloat(document.getElementById("annual_rate").value) || 12;
            const years = parseFloat(document.getElementById("years").value) || 10;

            const months = years * 12;
            const monthlyRate = rate / (12 * 100);
            const futureValue = monthly * (((1 + monthlyRate) ** months - 1) / monthlyRate) * (1 + monthlyRate);
            const formattedFV = futureValue.toLocaleString('en-IN', { maximumFractionDigits: 0 });

            document.getElementById("aiAdvice").innerHTML =
                `ðŸ’¬ If you invest <span class='highlight'>â‚¹${monthly}</span> monthly for 
                 <span class='highlight'>${years} years</span> at 
                 <span class='highlight'>${rate}%</span> annual rate, 
                 you could get around <span class='highlight'>â‚¹${formattedFV}</span>.`;

            if (document.getElementById("insightSection").style.display === "block") {
                updateChart(monthly, rate, years);
            }
        }

        function toggleInsights() {
            const section = document.getElementById("insightSection");
            const btn = document.getElementById("showInsights");

            if (section.style.display === "none" || section.style.display === "") {
                section.style.display = "block";
                btn.textContent = "ðŸ“‰ Hide Insights";
                updateChart();
            } else {
                section.style.display = "none";
                btn.textContent = "ðŸ“ˆ Show More Insights";
            }
        }

        function updateChart(monthly = 2000, rate = 12, years = 10) {
            const months = years * 12;
            const monthlyRate = rate / (12 * 100);
            const labels = [];
            const values = [];

            for (let i = 1; i <= months; i++) {
                const val = monthly * (((1 + monthlyRate) ** i - 1) / monthlyRate) * (1 + monthlyRate);
                labels.push(i);
                values.push(val);
            }

            const ctx = document.getElementById('growthChart').getContext('2d');
            if (chart) chart.destroy();

            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels.map(m => m + "m"),
                    datasets: [
                        {
                            label: 'Portfolio Value (â‚¹)',
                            data: values,
                            borderColor: '#0d47a1',
                            borderWidth: 2,
                            fill: true,
                            backgroundColor: 'rgba(13, 71, 161, 0.15)',
                            tension: 0.2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: { y: { beginAtZero: true } },
                    plugins: { legend: { display: true } }
                }
            });

            const finalValue = values[values.length - 1];
            const totalInvestment = monthly * months;
            const gain = finalValue - totalInvestment;
            const gainPct = (gain / totalInvestment * 100).toFixed(2);

            document.getElementById("aiInsightText").innerHTML =
                `ðŸ’¡ <b>AI Insight:</b> Over ${years} years, your investment of <span class='highlight'>â‚¹${totalInvestment.toLocaleString('en-IN')}</span> could grow to 
                 <span class='highlight'>â‚¹${finalValue.toLocaleString('en-IN')}</span>, 
                 giving you a gain of <span class='highlight'>â‚¹${gain.toLocaleString('en-IN')}</span> 
                 (about <span class='highlight'>${gainPct}%</span> return). Stay consistent for best results! ðŸ’ª`;
        }
    </script>
</body>
</html>
